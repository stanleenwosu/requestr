<section>
  <form [formGroup]="depositForm" (ngSubmit)="makePayment()">
    <div *ngIf="amountConfirmed === false; else amtConfirmed">
      <nb-card>
        <nb-card-header>
          Make a Deposit
        </nb-card-header>
        <nb-card-body>
          <div class="input-group">
            <label for="amount">Enter Amount</label>
            <input nbInput fullWidth fieldSize="giant" type="text" name="amount" class="form-control text-large"
              formControlName="amount">
          </div>
          <button type="button" nbButton fullWidth status="primary" (click)="confirmAmount()">Confirm Amount</button>
        </nb-card-body>
      </nb-card>
    </div>

    <ng-template #amtConfirmed>
      <nb-card [nbSpinner]="loading">
        <nb-card-header>Make a Deposit</nb-card-header>
        <nb-card-body>
          <div *ngIf="paymentConfirmed === false; else pmtConfirmed" class="text-center">
            <h3>You are about to deposit <span class="text-primary">{{ depositForm.value['amount'] | currency}}</span>
              into your account</h3>
            <nb-select (selectedChange)="changeDepositInfo()" formControlName="channel" [size]="'giant'"
              [fullWidth]="true" placeholder="Select Payment Type">
              <nb-option *ngFor="let channel of pca" [value]="channel">{{ channel }}</nb-option>
            </nb-select>
            <div class="py-3">
              <nb-icon icon="credit-card-outline" class="large"></nb-icon>
              <p>Send Payment to the Following Address</p>
              <h4>{{ depositInfo }}</h4>
            </div>
            <button type="submit" nbButton fullWidth status="primary">Make Payment</button>
          </div>
          <ng-template #pmtConfirmed>
            <div class="text-center">
              <nb-icon icon="credit-card-outline" class="large"></nb-icon>
              <h4>Your payment is being processed and you'll be notified as soon as it is confirmed</h4>
              <button type="button" nbButton status="primary">View Payment Info</button>
            </div>
          </ng-template>
        </nb-card-body>
      </nb-card>
    </ng-template>
  </form>
</section>
